## @file
## Define main PVs

# % macro, P, device prefix

## Set to disable bean information updates
record(bo, "$(P)ISISBEAM:DISABLE") 
{
    field(DESC, "Disable comms")
    field(PINI, "YES")
    field(VAL, "0")
    field(OMSL, "supervisory")
    field(ZNAM, "COMMS ENABLED")
    field(ONAM, "COMMS DISABLED")
}

## TS1 Beam current
record(ai, "$(P)AC:TS1:BEAM:CURR")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)BEAMTS1")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(FLNK, "$(P)AC:TS1:BEAM:STAT")
#   field(TSE, -2)
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS1 Beam Current")
   field(EGU, "uA")
   field(HOPR, "250")
   field(LOPR, "0")
   field(LOW, "1")
   field(LSV, "MINOR")
}

## TS2 Beam current
record(ai, "$(P)AC:TS2:BEAM:CURR")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)BEAMTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(FLNK, "$(P)AC:TS2:BEAM:STAT")
#   field(TSE, -2)
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS2 Beam Current")
   field(EGU, "uA")
   field(HOPR, "60")
   field(LOPR, "0")
   field(LOW, "1")
   field(LSV, "MINOR")
}

record(ai, "$(P)AC:EPB1:BEAM:CURR")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)BEAMEPB1")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
#   field(TSE, -2)
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "EPB1 Beam Current")
   field(EGU, "uA")
   field(HOPR, "300")
   field(LOPR, "0")
   field(LOW, "1")
   field(LSV, "MINOR")
}

record(ai, "$(P)TG:TS1:MOD:METH:TEMP")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)METHTS1")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
#   field(TSE, -2)
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS1 Methane Moderator Temperature")
   field(EGU, "K")
   field(HOPR, "300")
   field(LOPR, "80")
   field(HIGH, "150")
   field(HSV, "MINOR")
}

record(ai, "$(P)TG:TS1:MOD:HDGN:TEMP")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)HDGNTS1")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
#   field(TSE, -2)
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS1 Hydrogen Moderator Temperature")
   field(EGU, "K")
   field(HOPR, "300")
   field(LOPR, "15")
   field(HIGH, "30")
   field(HSV, "MINOR")
}

record(ai, "$(P)AC:SYNCH:BEAM:CURR")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)BEAMSYNCH")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "Synchrotron Beam Current")
   field(EGU, "uA")
   field(HOPR, "300")
   field(LOPR, "0")
   field(LOW, "1")
   field(LSV, "MINOR")
}

record(ai, "$(P)AC:SYNCH:FREQ")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)FREQSYNCH")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "Synchrotron Frequency")
   field(EGU, "Hz")
   field(HOPR, "50")
   field(LOPR, "0")
   field(LOW, "1")
   field(LSV, "MINOR")
}

record(ai, "$(P)AC:TS1:FREQ")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)FREQSYNCH")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS1 Frequency")
   field(EGU, "Hz")
   field(HOPR, "50")
   field(LOPR, "0")
   field(LOW, "1")
   field(LSV, "MINOR")
}

record(waveform, "$(P)TG:TS1:INST")
{
   field(DTYP, "asynOctetRead")
   field(INP,  "@asyn(isisbeam,0,0)INSTTS1")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(FTVL, "CHAR")
   field(NELM, "512")
}

record(waveform, "$(P)TG:TS2:INST")
{
   field(DTYP, "asynOctetRead")
   field(INP,  "@asyn(isisbeam,0,0)INSTTS2")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(FTVL, "CHAR")
   field(NELM, "512")
}

record(stringin, "$(P)TG:UPDTIME")
{
   field(DTYP, "asynOctetRead")
   field(INP,  "@asyn(isisbeam,0,0)UPDTIME")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
}

record(longin, "$(P)TG:UPDTIMET")
{
   field(DTYP, "asynInt32")
   field(INP,  "@asyn(isisbeam,0,0)UPDTIMET")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
}

record(bi, "$(P)IN:OSIRIS:CRYOMAG")
{
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(ZNAM, "Idle State")
   field(ONAM, "Rising")
   field(VAL, "0")
}

record(ai, "$(P)AC:TS1:BEAM:TOTAL")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)TOTALTS1")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS1 Total microamps since midnight")
   field(EGU, "uAH")
}

record(ai, "$(P)AC:TS1:BEAM:YEST")
{
#   field(DTYP, "asynFloat64")
#   field(INP,  "@asyn(isisbeam,0,0)TOTALTS1")
   field(PREC, "3")
#   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS1 Total microamps yesderday")
   field(EGU, "uAH")
   field(VAL, "11.0")
}

record(ai, "$(P)AC:TS2:FREQ")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)FREQTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS2 Frequency")
   field(EGU, "Hz")
   field(HOPR, "10")
   field(LOPR, "0")
   field(LOW, "1")
   field(LSV, "MINOR")
}

record(ai, "$(P)AC:TS2:BEAM:TOTAL")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)TOTALTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS2 Total microamps since midnight")
   field(EGU, "uAH")
}

record(ai, "$(P)AC:TS2:BEAM:YEST")
{
#   field(DTYP, "asynFloat64")
#   field(INP,  "@asyn(isisbeam,0,0)TOTALTS1")
   field(PREC, "3")
#   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS2 Total microamps yesderday")
   field(EGU, "uAH")
   field(VAL, "21.0")
}

record(ai, "$(P)AC:TS2:DMOD:METH:TEMP")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)DEMETHTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS2 Decoupled Methane Temperature")
   field(EGU, "K")
   field(HOPR, "300")
   field(LOPR, "40")
   field(HIGH, "65")
   field(HSV, "MINOR")
}

record(ai, "$(P)TG:TS2:CMOD:METH:TEMP")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)METHTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS2 Coupled Methane Temperature")
   field(EGU, "K")
   field(HOPR, "300")
   field(LOPR, "40")
   field(HIGH, "65")
   field(HSV, "MINOR")
}

record(ai, "$(P)TG:TS2:CMOD:HDGN:TEMP")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)HDGNTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(DESC, "TS2 Coupled Hydrogen Temperature")
   field(EGU, "K")
   field(HOPR, "300")
   field(LOPR, "10")
   field(HIGH, "30")
   field(HSV, "MINOR")
}

record(ai, "$(P)AC:TS2:DMOD:RTIME:DUR")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)DRUNTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(EGU, "s")
}

record(ai, "$(P)AC:TS2:DMOD:RTLIM")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)DRLIMTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(EGU, "s")
}

record(ai, "$(P)AC:TS2:DMOD:BEAM")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)BEAMDMODTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
   field(EGU, "uAh")
}

record(bi, "$(P)AC:TS1:BEAM:STAT")
{
	field(DTYP, "Soft Channel")
	field(INP, "$(P)AC:TS1:BEAM:ONCALC PP")
	field(ZNAM, "OFF")
	field(ONAM, "ON")
}

record(calc, "$(P)AC:TS1:BEAM:ONCALC")
{
	field(INPA, "$(P)AC:TS1:BEAM:CURR NPP")
	field(CALC, "A>0?1:0")
}

record(bi, "$(P)AC:TS2:BEAM:STAT")
{
	field(DTYP, "Soft Channel")
	field(INP, "$(P)AC:TS2:BEAM:ONCALC PP")
	field(ZNAM, "OFF")
	field(ONAM, "ON")
}

record(calc, "$(P)AC:TS2:BEAM:ONCALC")
{
	field(INPA, "$(P)AC:TS2:BEAM:CURR NPP")
	field(CALC, "A>0?1:0")
}

record(ai, "$(P)BL:MUON:KICKR")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)MUKICK")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(FLNK, "$(P)BL:MUON:KICKR:STAT")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
}

record(bi, "$(P)BL:MUON:KICKR:STAT")
{
	field(DTYP, "Soft Channel")
	field(INP, "$(P)AC:MUON:KICKR:ONCALC PP")
	field(ZNAM, "OFF")
	field(ONAM, "ON")
}

record(calc, "$(P)AC:MUON:KICKR:ONCALC")
{
	field(INPA, "$(P)AC:MUON:KICKR NPP")
	field(CALC, "A#0?1:0")
}

record(bi, "$(P)AC:TS2:DMOD:ANNPLOW:STAT")
{
    field(DESC, "TS2 DMOD Methane Anneal Pressure Low")
	field(DTYP, "Soft Channel")
	field(INP, "$(P)AC:TS2:DMOD:ANCLC PP")
	field(ZNAM, "NO")
	field(ONAM, "YES")
}

record(calc, "$(P)AC:TS2:DMOD:ANCLC")
{
	field(INPA, "$(P)AC:TS2:DMOD:ANN NPP")
	field(CALC, "A>0?1:0")
}

record(ai, "$(P)AC:TS2:DMOD:ANN")
{
   field(DTYP, "asynFloat64")
   field(INP,  "@asyn(isisbeam,0,0)DMODANNLOWTS2")
   field(PREC, "3")
   field(SCAN, "I/O Intr")
   field(FLNK, "$(P)AC:TS2:DMOD:ANNPLOW:STAT")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
}

record(stringin, "$(P)AC:TS1:BEAMON:TIME")
{
   field(DTYP, "asynOctetRead")
   field(INP,  "@asyn(isisbeam,0,0)ONTS1")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
}

record(stringin, "$(P)AC:TS1:BEAMOFF:TIME")
{
   field(DTYP, "asynOctetRead")
   field(INP,  "@asyn(isisbeam,0,0)OFFTS1")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
}

record(stringin, "$(P)AC:TS2:BEAMON:TIME")
{
   field(DTYP, "asynOctetRead")
   field(INP,  "@asyn(isisbeam,0,0)ONTS2")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
}

record(stringin, "$(P)AC:TS2:BEAMOFF:TIME")
{
   field(DTYP, "asynOctetRead")
   field(INP,  "@asyn(isisbeam,0,0)OFFTS2")
   field(SCAN, "I/O Intr")
   field(SDIS, "$(P)ISISBEAM:DISABLE")
}

# Renamed certain PVs for correctness, corrected CSS screen, but just in case have aliased as well
alias("$(P)TG:TS2:CMOD:METH:TEMP","$(P)AC:TS2:CMOD:METH:TEMP")
alias("$(P)TG:TS2:CMOD:HDGN:TEMP","$(P)AC:TS2:CMOD:HDGN:TEMP")
alias("$(P)BL:MUON:KICKR","$(P)AC:MUON:KICKR")
alias("$(P)BL:MUON:KICKR:STAT","$(P)AC:MUON:KICKR:STAT")
